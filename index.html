<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>cha-syuOS v0.5</title>
<link rel="manifest" href="manifest.json">
<meta name="theme-color" content="#000000">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black">

<style>
body{
  margin:0;
  font-family:Segoe UI, sans-serif;
  overflow:hidden;
  background:black;
}

/* Desktop */
#desktop{
  display:none;
  height:100vh;
  background:linear-gradient(135deg,#0f2027,#203a43,#2c5364);
  position:relative;
  color:white;
}

/* Icons */
.iconArea{
  display:flex;
  padding:20px;
}
.icon{
  width:80px;
  text-align:center;
  cursor:pointer;
  margin:20px;
}

/* App Icon (Game„Å™„Å©) */
.app-icon {
  display: inline-flex;
  flex-direction: column;
  align-items: center;
  width:80px;
  margin:20px;
  cursor: pointer;
}
.app-icon .icon {
  font-size: 40px;
  line-height: 1;
  text-align: center;
}
.app-icon .label {
  font-size: 14px;
  margin-top: 4px;
  text-align: center;
  color: white;
}

/* Taskbar */
#taskbar{
  position:absolute;
  bottom:0;
  width:100%;
  height:50px;
  background:rgba(0,0,0,0.5);
  display:flex;
  align-items:center;
  justify-content:space-between;
  padding:0 20px;
}
#startBtn{cursor:pointer;}
#clock{font-size:20px;}

/* Game Container */
#gameContainer{
  display:none;
  position:absolute;
  top:0; left:0;
  width:100%; height:100%;
  background:black;
}
#gameContainer canvas{
  display:block;
}

/* Buttons */
#restartBtn, #homeBtn{
  position:absolute;
  left:50%;
  padding:15px 30px;
  font-size:30px;
  cursor:pointer;
  display:none;
  transform:translate(-50%,0);
}
#restartBtn{top:60%;}
#homeBtn{top:70%;}
</style>
</head>

<body>

<div id="desktop">
  <!-- Game„Ç¢„Ç§„Ç≥„É≥ -->
  <div class="app-icon" onclick="openGame()">
    <div class="icon">üü©</div>
    <div class="label">Game</div>
  </div>

  <div id="taskbar">
    <div id="startBtn">Start</div>
    <div id="clock"></div>
  </div>
</div>

<!-- „Ç≤„Éº„É†ÁîªÈù¢ -->
<div id="gameContainer">
  <canvas id="gameCanvas"></canvas>
  <button id="restartBtn">„É™„Çπ„Çø„Éº„Éà</button>
  <button id="homeBtn">„Éõ„Éº„É†„Å´Êàª„Çã</button>
</div>

<script>
// ------------------ „Éá„Çπ„ÇØ„Éà„ÉÉ„Éó ------------------
const desktop = document.getElementById("desktop");

function updateClock(){
  const now = new Date();
  document.getElementById("clock").innerHTML=
    now.getFullYear()+"/"+
    String(now.getMonth()+1).padStart(2,'0')+"/"+
    String(now.getDate()).padStart(2,'0')+" "+
    String(now.getHours()).padStart(2,'0')+":"+
    String(now.getMinutes()).padStart(2,'0');
}
setInterval(updateClock,1000);
updateClock();

// ------------------ „Ç≤„Éº„É† ------------------
const gameContainer = document.getElementById("gameContainer");
const canvas = document.getElementById("gameCanvas");
const ctx = canvas.getContext("2d");
const restartBtn = document.getElementById("restartBtn");
const homeBtn = document.getElementById("homeBtn");

canvas.width = window.innerWidth;
canvas.height = window.innerHeight;

let player, enemies, score, gameOver;

function initGame(){
  player = { x:100, y:100, size:40 };
  enemies = [];
  for(let i=0;i<30;i++){
    enemies.push({
      x: Math.random()*canvas.width,
      y: Math.random()*canvas.height,
      size:40,
      speed:1 + Math.random()*2
    });
  }
  score = 0;
  gameOver = false;
  restartBtn.style.display = "none";
  homeBtn.style.display = "none";
}

function draw(){
  ctx.clearRect(0,0,canvas.width,canvas.height);

  if(gameOver){
    ctx.fillStyle="white";
    ctx.font="80px serif";
    ctx.fillText("„Å©„Çì„Åæ„ÅÑ Á¨ë", canvas.width/2 - 200, canvas.height/2);
    restartBtn.style.display = "block";
    homeBtn.style.display = "block";
    return;
  }

  // „Éó„É¨„Ç§„É§„ÉºÊèèÁîª
  ctx.fillStyle="lime";
  ctx.fillRect(player.x,player.y,player.size,player.size);

  // ÊïµÂá¶ÁêÜ
  enemies.forEach(enemy=>{
    if(player.x>enemy.x) enemy.x += enemy.speed;
    if(player.x<enemy.x) enemy.x -= enemy.speed;
    if(player.y>enemy.y) enemy.y += enemy.speed;
    if(player.y<enemy.y) enemy.y -= enemy.speed;

    ctx.fillStyle="red";
    ctx.fillRect(enemy.x,enemy.y,enemy.size,enemy.size);

    // ÂΩì„Åü„ÇäÂà§ÂÆö
    if(player.x<enemy.x+enemy.size &&
       player.x+player.size>enemy.x &&
       player.y<enemy.y+enemy.size &&
       player.y+player.size>enemy.y){
      gameOver = true;
    }
  });

  ctx.fillStyle="white";
  ctx.font="40px Arial";
  ctx.fillText("Score: "+score,20,30);

  requestAnimationFrame(draw);
}

// „Çø„ÉÉ„ÉÅ„Åß„Éó„É¨„Ç§„É§„ÉºÁßªÂãï
canvas.addEventListener("touchstart",e=>{
  if(!gameOver){
    player.x = e.touches[0].clientX - player.size/2;
    player.y = e.touches[0].clientY - player.size/2;
    score++;
  }
});

// ------------------ „Éú„Çø„É≥ ------------------
restartBtn.addEventListener("click", ()=>{
  initGame();
  draw();
});

homeBtn.addEventListener("click", ()=>{
  gameContainer.style.display="none";
  desktop.style.display="block";
});

// ------------------ „Ç≤„Éº„É†Ëµ∑Âãï ------------------
function openGame(){
  desktop.style.display="none";
  gameContainer.style.display="block";
  initGame();
  draw();
}
</script>
</body>
</html>
